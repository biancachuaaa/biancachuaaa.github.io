<html>
    <head>
        <meta content="text/htmlcharset=utf-8" http-equiv="Content-Type">
        <meta content="utf-8" http-equiv="encoding">
        <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet'>
        <title>Edit</title>
        <link rel="stylesheet" type="text/css" href="styles.css">
    </head>

    <body>
        <div class="login_box">
            <div id = "logo_position">
                <img id="logo_login" src="BC_logo_white.png">
            </div>
            <div class="authentication">
                <form class="login">
                    <input id ="email" type="text" placeholder="email">
                    <input id ="password" type="password" placeholder="password">
                    <button id = "login">Login</button>
                </form>
            </div>
        </div>

        <div id = "editable_info">
            <header>
                <div id="logo_placement">
                    <img id="logo" src="BC_logo_white.png">
                </div>
            </header>
        
            <div id="about_template">
                    <div id = "intro_border">
                        <div id = "introduction"></div>
                    </div>
                    <button id = "about_edit">Edit</button>

                    <div id="modal1" class="modal"> 
                        <div id="descript_modal" class="modal-content">
                            <span class="close">&times;</span>
                            <h1>Description</h1>
                            <form id="intro">
                                <input id = "edit_descript" type="text" placeholder="Edit description">
                                <button id = "edit_submit">Submit</button>
                            </form>
                        </div>
                    </div>

                    <div id = "hobbies">
                        <span id="hobbies_title">Hobbies</span>
                    </div>
            </div>
        
            <div id ="organizations">Organizations</div>
            <div id="org_container"></div>
    
            <div id ="organizations">Education Timeline</div>
            <div id = "education_template"></div>
        
            <div id ="organizations">Works</div>
            <div id = "work_template">
                <div id = "project"></div>
            </div>
        
        
            <footer id = "container2">
                <div id = "contact">CONTACT ME</div>
            </footer>
        </div>



         <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.17.1/firebase-app.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
        https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/7.17.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.17.1/firebase-auth.js"></script>

    <script>
        // Your web app's Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyDCI8R3edblRVJJikXdJX4WEruo5VwMO8U",
            authDomain: "mp1-resume.firebaseapp.com",
            databaseURL: "https://mp1-resume.firebaseio.com",
            projectId: "mp1-resume",
            storageBucket: "mp1-resume.appspot.com",
            messagingSenderId: "237909837691",
            appId: "1:237909837691:web:7d7e1cd429a0a7c5915fde"
        };
        // Initialize Firebase
        var defaultPorject = firebase.initializeApp(firebaseConfig);
        var db = firebase.firestore();

        document.getElementById("editable_info").style.display = "none";


        document.getElementById("login").addEventListener("click", function(e){
            e.preventDefault();
            var email = document.getElementById("email").value;
            var password = document.getElementById("password").value;

            firebase.auth().signInWithEmailAndPassword(email,password).then(function(user){
                console.log(email);
                console.log(password);
                console.log("success");
                document.getElementsByClassName("login_box")[0].style.display = "none";
                document.getElementById("editable_info").style.display = "block";
        
                db.collection("about").get().then((snapshot) => {
                    snapshot.forEach((doc) => {
                        document.getElementById('introduction').innerHTML += `${doc.data().introduction}`;
                    });
                });

                db.collection("contact").get().then((snapshot) =>{
                    snapshot.forEach((doc) => {
                        document.getElementById('container2').innerHTML += `<img class="sm_logo" src ="${doc.data().logo}">`;
                        document.getElementById('container2').innerHTML += `<a href="${doc.data().url}">${doc.data().username}</a>`;
                    });
                });

                db.collection("hobbies").get().then((snapshot) =>{
                    snapshot.forEach((doc) => {
                        document.getElementById('hobbies').innerHTML += `<li>${doc.data().hobby}</li>`;
                    });
                });

                db.collection("organizations").get().then((snapshot) =>{
                    snapshot.forEach((doc) => {
                        document.getElementById('org_container').innerHTML += `<div id = "orgs"><img class="org_logo" src ="${doc.data().logo}"><br>${doc.data().org_name}<br>${doc.data().position}</div>`;
                    });
                });

                db.collection("educations").orderBy('year_start','asc').get().then((snapshot) =>{
                        snapshot.forEach((doc) => {
                            document.getElementById('education_template').innerHTML += `<div id = "edu_logo_template"><img class="education_logo" src ="${doc.data().logo}"></div>`;
                            if((doc.data().grade_start && doc.data().grade_end && doc.data().year_end) == null){
                                document.getElementById('education_template').innerHTML += `<div id = "education_details">${doc.data().school}<br><br> A.Y. ${doc.data().year_start} - Present</div>`;
                            }
                            else if(doc.data().grade_end == doc.data().grade_start){
                                document.getElementById('education_template').innerHTML += `<div id = "education_details">${doc.data().school}<br><br> A.Y. ${doc.data().year_start} - ${doc.data().year_end} | Grade ${doc.data().grade_start}</div>`;   
                            }
                            else{
                                document.getElementById('education_template').innerHTML += `<div id = "education_details">${doc.data().school}<br><br> A.Y. ${doc.data().year_start} - ${doc.data().year_end} | Grades ${doc.data().grade_start}-${doc.data().grade_end}</div>`;    
                            }
                        });
                    });
                
                db.collection("works").get().then((snapshot) =>{
                        snapshot.forEach((doc) => {
                            document.getElementById('project').innerHTML += `<a href="${doc.data().link}">${doc.data().name}</a><br><br>`;
                            document.getElementById('project').innerHTML += `<div id = "description">Programming language used: ${doc.data().lab}<br><br>${doc.data().description}<br><br><br>`;
                        });
                    });
                });

                var modal1 = document.getElementById("modal1");
                var aboutbtn = document.getElementById("about_edit");
                var close = document.getElementsByClassName("close")[0];

                aboutbtn.addEventListener("click", openModal);
                close.addEventListener("click", closeModal);

                function openModal(){
                    modal1.style.display = "block";
                }

                function closeModal(){
                    modal1.style.display = "none";
                }

                

        })

    </script>

    </body>
</html>